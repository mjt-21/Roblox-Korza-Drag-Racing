-- Services
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local ServerStorage = game:GetService("ServerStorage")

-- Variables
local RemoteFunction = ReplicatedStorage:WaitForChild("PlayerNumFunction")

local Time1 = ServerStorage.PlayerTimes.Time1
local Time2 = ServerStorage.PlayerTimes.Time2
local Time3 = ServerStorage.PlayerTimes.Time3
local Time4 = ServerStorage.PlayerTimes.Time4

-- Creates Main Table
local PlayerAssignments = {
	Player1 = {Name = "1nil", Time = Time1},
	Player2 = {Name = "2nil", Time = Time2},
	Player3 = {Name = "3nil", Time = Time3},
	Player4 = {Name = "4nil", Time = Time4}
}

RemoteFunction.OnServerInvoke = function(Player, LocalRaceTime) -- Checks for when RemoteFunction fires to server, then does the below
	
	for Var, Players in pairs(PlayerAssignments) do -- Cycles through the table
		if Players.Name == "1nil" then
			Players.Name = Player.Name -- Makes the name in the table equal to what the player name is 
			LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
			Players.Time.Changed:Connect(function()
				LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
				print(Players.Name .. " " .. Players.Time.Value)
			end)
			break -- Stops the loop
			-- Continues on doing the same thing, checking each name value in the table
		elseif
			Players.Name == "2nil" then
			Players.Name = Player.Name
			LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
			Players.Time.Changed:Connect(function()
				LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
				print(Players.Name .. " " .. Players.Time.Value)
			end)
			break
		elseif
			Players.Name == "3nil" then
			Players.Name = Player.Name
			LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
			Players.Time.Changed:Connect(function()
				LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
				print(Players.Name .. " " .. Players.Time.Value)
			end)
			break
		elseif
			Players.Name == "4nil" then
			Players.Name = Player.Name
			LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
			Players.Time.Changed:Connect(function()
				LocalRaceTime.Value = Players.Time.Value -- Makes the localracetime be equal to what is in the server time value
				print(Players.Name .. " " .. Players.Time.Value)
			end)
			break
		end
	end
end
